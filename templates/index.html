<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>成理工程教务助手</title>
    <link rel="stylesheet" href="/static/css/style.css" />
  </head>
  <body>
    <div class="page">
      <header class="hero">
        <div>
          <p class="eyebrow">CDUTETC 教务系统</p>
          <h1>成理工程教务助手</h1>
          <p class="subtitle">
            统一操作面板，覆盖账号管理、课表与成绩查询，让每一次操作都清晰可控。
          </p>
        </div>
        <div class="hero-actions">
          <button class="primary" id="btn-check-login">检测本地账号</button>
          <button class="ghost" id="btn-login-local">使用已保存账号登录</button>
        </div>
      </header>

      <nav class="tabs" aria-label="功能分页">
        <button class="tab" data-tab="login" aria-selected="true">登录</button>
        <button class="tab" data-tab="timetable" aria-selected="false">课表</button>
        <button class="tab" data-tab="score" aria-selected="false">成绩</button>
        <button class="tab" data-tab="profile" aria-selected="false">个人信息</button>
      </nav>

      <main>
        <section class="section tab-page" data-page="login">
          <div class="section-title">
            <h2>第一步：登录</h2>
            <p>请先完成登录，成功后将解锁课表、成绩与个人信息模块。</p>
          </div>
          <div class="grid two">
            <div class="card">
              <h3>账号登录</h3>
              <form id="login-form" class="form">
                <label>
                  学号
                  <input type="text" name="username" placeholder="请输入学号" required />
                </label>
                <label>
                  密码
                  <input type="password" name="password" placeholder="请输入密码" required />
                </label>
                <button class="primary" type="submit">登录并同步</button>
              </form>
              <div class="hint">支持 POST /api/login 接口。</div>
            </div>
            <div class="card">
              <h3>登录状态</h3>
              <p class="muted">
                登录成功后即可使用课表查询、成绩统计与个人信息更新。
              </p>
              <div class="status-box" id="login-status-box">
                <span class="status" data-status="idle">未登录</span>
                <span class="result-msg">请先完成登录。</span>
              </div>
              <div class="hint">登录成功后切换到其他分页继续操作。</div>
            </div>
          </div>
          <div class="result" id="account-result">
            <div class="result-header">
              <span class="status" data-status="idle">账号状态</span>
              <span class="result-msg">请先选择操作。</span>
            </div>
            <div class="result-body"></div>
          </div>
        </section>

        <section class="section tab-page" data-page="timetable" hidden>
          <div class="section-title">
            <h2>课表服务</h2>
            <p>查询完整课表、今日/当前课程以及自然语言日期解析。</p>
          </div>
          <div class="grid three">
            <div class="card">
              <h3>快速查询</h3>
              <div class="actions-column">
                <button class="primary" id="btn-timetable">获取完整课表</button>
                <button class="ghost" id="btn-today">今日课程</button>
                <button class="ghost" id="btn-now">当前课程</button>
                <button class="ghost" id="btn-refresh">刷新课表</button>
              </div>
              <div class="hint">课表接口前缀：/timetable</div>
            </div>
            <div class="card">
              <h3>指定日期</h3>
              <div class="form">
                <label>
                  查询天数（天后）
                  <input type="number" id="days-input" min="0" value="1" />
                </label>
                <button class="primary" id="btn-days">查询指定天数后</button>
                <label>
                  日期（YYYY-MM-DD）
                  <input type="date" id="date-input" />
                </label>
                <button class="ghost" id="btn-date">查询指定日期</button>
              </div>
            </div>
            <div class="card">
              <h3>自然语言查询</h3>
              <div class="form">
                <label>
                  文本描述
                  <input type="text" id="text-input" placeholder="例如：明天 / 下周三 / 2026-01-16" />
                </label>
                <button class="primary" id="btn-text">解析并查询</button>
              </div>
            </div>
          </div>
          <div class="result" id="timetable-result">
            <div class="result-header">
              <span class="status" data-status="idle">课表结果</span>
              <span class="result-msg">等待查询。</span>
            </div>
            <div class="result-body"></div>
          </div>
        </section>

        <section class="section tab-page" data-page="score" hidden>
          <div class="section-title">
            <h2>成绩与学分统计</h2>
            <p>覆盖历史成绩、学期成绩、重修缴费与学分统计。</p>
          </div>
          <div class="grid two">
              <div class="card">
                <h3>成绩查询</h3>
                <div class="actions-column">
                  <button class="primary" id="btn-score-semester">本学期成绩</button>
                  <button class="ghost" id="btn-score-all">历史成绩</button>
                  <button class="ghost" id="btn-score-update">实时更新</button>
                </div>
              </div>
            <div class="card">
              <h3>学分与缴费</h3>
              <div class="actions-column">
                <button class="primary" id="btn-score-credits">累计学分统计（仅统计必修学分）</button>
                <button class="ghost" id="btn-score-retake">重修缴费统计</button>
              </div>
            </div>
          </div>
          <div class="result" id="score-result">
            <div class="result-header">
              <span class="status" data-status="idle">成绩结果</span>
              <span class="result-msg">等待查询。</span>
            </div>
            <div class="result-body"></div>
          </div>
        </section>

        <section class="section tab-page" data-page="profile" hidden>
          <div class="section-title">
            <h2>个人信息与邮件通知</h2>
            <p>更新账号、密码与邮件通知配置。</p>
          </div>
          <div class="grid two">
            <div class="card">
              <h3>账号与邮箱信息</h3>
              <form id="user-info-form" class="form">
                <label>
                  学号
                  <input type="text" name="username" placeholder="支持更新" />
                </label>
                <label>
                  密码
                  <input type="password" name="password" placeholder="支持更新" />
                </label>
                <label>
                  发送邮箱
                  <input type="email" name="email_sender" placeholder="example@qq.com" />
                </label>
                <label>
                  邮箱授权码
                  <input type="password" name="email_password" placeholder="授权码/应用密码" />
                </label>
                <label>
                  接收邮箱
                  <input type="email" name="email_to" placeholder="接收通知的邮箱" />
                </label>
                <button class="primary" type="submit">保存信息</button>
              </form>
              <div class="actions-row">
                <button class="ghost" id="btn-enable-email">启用邮件通知</button>
                <button class="ghost" id="btn-disable-email">关闭邮件通知</button>
              </div>
              <div class="hint">支持 POST /api/change_user_info 与 /score 邮件接口。</div>
            </div>
            <div class="card">
              <h3>建议</h3>
              <ul class="hint-list">
                <li>先保存邮箱信息，再启用邮件通知。</li>
                <li>修改密码后请重新登录以刷新状态。</li>
                <li>成绩更新可能需要等待一段时间。</li>
              </ul>
            </div>
          </div>
        </section>
      </main>

      <footer class="footer">
        <p>提交bug或滥用投诉请联系开发者Guesser email: <a href="mailto:cdutect_report@guesser.eu.org">cdutect_report@guesser.eu.org</a></p>      </footer>
    </div>

    <div class="modal" id="disclaimer-modal" aria-hidden="true">
      <div class="modal-content">
        <div class="modal-header">
          <h2>免责声明</h2>
          <p>使用本项目即表示你已阅读并同意以下条款。</p>
        </div>
        <div class="modal-body">
          <p>本项目仅供学习、研究及个人使用，所有自动化操作须由用户本人授权并仅访问本人账号。</p>
          <p>用户需确保使用行为符合当地法律法规及学校官网使用条款，因违规造成的后果由用户承担。</p>
          <p>自动化登录可能存在被识别、阻断或封禁的风险，项目作者不对功能失效或数据错误负责。</p>
          <p>项目按“现状”提供，不提供任何形式担保，使用本项目产生的损失由用户自行承担。</p>
          <p>
              本项目不会向开发者上传或收集您的任何个人信息，所有网络请求仅与官方网站进行通信。
              项目源代码已在 GitHub 上开源：
              <a href="https://github.com/biubiu258/cdutetc" target="_blank" rel="noopener noreferrer">
                https://github.com/biubiu258/cdutetc
              </a>
          </p>

        </div>
        <div class="modal-actions">
          <button class="primary" id="btn-accept">我已阅读并同意</button>
        </div>
      </div>
    </div>

    <div class="global-loader" id="global-loader" aria-hidden="true">
      <div class="spinner"></div>
      <p>正在处理，请稍候...</p>
    </div>

    <script src="/static/js/app.js"></script>
  </body>
</html>